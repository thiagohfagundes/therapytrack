<dialog id="modal"
        style="max-width:680px;width:96%;border:none;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.2);">
  <form method="post"
        hx-post="{% url 'terapias:novo-item-rotina' rotina.pk %}"
        hx-target="#modal"
        hx-swap="outerHTML">
    {% csrf_token %}

    <div style="padding:16px 20px;border-bottom:1px solid #e5e7eb;display:flex;justify-content:space-between;align-items:center;">
      <h3 style="margin:0;">Novo item da rotina</h3>
      <button type="button" onclick="this.closest('dialog').close()">✕</button>
    </div>

    <div style="padding:16px 20px;display:grid;gap:12px;">
      {{ form.non_field_errors }}

      <div>
        <label for="{{ form.nome_evento.id_for_label }}">Título</label>
        {{ form.nome_evento }} {{ form.nome_evento.errors }}
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label for="{{ form.periodicidade.id_for_label }}">Periodicidade</label>
          {{ form.periodicidade }} {{ form.periodicidade.errors }}
        </div>
        <div>
          <div style="font-size:.9rem;">Dias da semana</div>
          {{ form.dias_semana_multi }} {{ form.dias_semana_multi.errors }}
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label for="{{ form.hora_inicio.id_for_label }}">Início</label>
          {{ form.hora_inicio }} {{ form.hora_inicio.errors }}
        </div>
        <div>
          <label for="{{ form.hora_fim.id_for_label }}">Término</label>
          {{ form.hora_fim }} {{ form.hora_fim.errors }}
        </div>
      </div>

      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px;">
        <div>
          <label for="{{ form.profissional.id_for_label }}">Profissional</label>
          {{ form.profissional }} {{ form.profissional.errors }}
        </div>
        <div>
          <label for="{{ form.clinica.id_for_label }}">Clínica</label>
          {{ form.clinica }} {{ form.clinica.errors }}
        </div>
      </div>

      <div>
        <label for="{{ form.descricao.id_for_label }}">Descrição</label>
        {{ form.descricao }} {{ form.descricao.errors }}
      </div>
    </div>

    <div style="padding:12px 20px;border-top:1px solid #e5e7eb;display:flex;justify-content:flex-end;gap:8px;">
      <button type="button" onclick="this.closest('dialog').close()">Cancelar</button>
      <button type="submit">Salvar</button>
    </div>
  </form>
</dialog>

<script>
  (function () {
    var dlg = document.getElementById('modal');
    if (dlg && typeof dlg.showModal === 'function' && !dlg.open) dlg.showModal();
  }());
</script>



